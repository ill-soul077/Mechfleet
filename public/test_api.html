<!DOCTYPE html>
<html>
<head>
    <title>Test Add Part</title>
    <script>
    function testAddPart() {
        const workId = document.getElementById('workId').value;
        const productId = document.getElementById('productId').value;
        const qty = document.getElementById('qty').value;
        
        const data = new FormData();
        data.append('work_id', workId);
        data.append('product_id', productId);
        data.append('quantity', qty);
        
        document.getElementById('result').innerHTML = 'Sending request...';
        
        fetch('api/add_work_part.php', {
            method: 'POST',
            body: data
        })
        .then(r => r.text())
        .then(text => {
            document.getElementById('result').innerHTML = '<pre>' + text + '</pre>';
            try {
                const json = JSON.parse(text);
                if(json.success) {
                    document.getElementById('result').innerHTML += '<br><b>SUCCESS!</b><br><a href="work_orders.php?id=' + workId + '">View Work Order</a>';
                }
            } catch(e) {
                document.getElementById('result').innerHTML += '<br><b>Parse Error:</b> ' + e.message;
            }
        })
        .catch(e => {
            document.getElementById('result').innerHTML = 'ERROR: ' + e.message;
        });
    }
    </script>
</head>
<body>
    <h1>Test Add Part API</h1>
    <div>
        <label>Work Order ID: <input type="number" id="workId" value="103"></label><br>
        <label>Product ID: <input type="number" id="productId" value="1"></label><br>
        <label>Quantity: <input type="number" id="qty" value="1"></label><br>
        <button onclick="testAddPart()">Add Part</button>
    </div>
    <div id="result"></div>
</body>
</html>
